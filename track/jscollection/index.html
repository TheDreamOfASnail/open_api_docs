<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="canonical" href="http://api-docs.convertlab.com/track/jscollection/"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <title>通过JS SDK进行事件采集 - Convertlab 文档中心</title>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../test/css/print.css" rel="stylesheet">

    
</head>
<body>
    <div class="navbar navbar-default" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="http://www.convertlab.com/">Convertlab 文档中心</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav navbar-right">
                
                  <li class="pull-left">
                    
                    <a href="../..">OpenAPI V1</a>
                    
                  </li>
                
                  <li class="pull-left active">
                    
                    <a href="./">网页埋点</a>
                    
                  </li>
                
                  <li class="pull-left">
                    
                    <a href="/test/">TRY IT</a>
                    
                  </li>
                </ul>
            
        </div>
    </div>
</div>
    <div class="container main">
       <!--   <div class="toolbar clearfix">
  <ol class="breadcrumb pull-left">
    <li><a href="">文档</a></li>
    <li>通过JS SDK进行事件采集</li>
  </ol>

  
    
      <a href="https://github.com/xsio/open_api_docs" class="github-edit pull-right"><i class="fa fa-github"></i> Edit on GitHub</a>
    
  

</div> -->
        <div class="col-md-3"><div class="bs-sidebar hidden-print" data-spy="affix" data-offset-top="80" role="complementary">
    <ul class="nav bs-sidenav">
     
      
        
      

    
      
        
          

              <li class="active">
                <a class="itm-l1" href="./">通过JS SDK进行事件采集</a>
                
                  <ul class="nav">
                  
                    <li class="active "><a href="#_1">设置埋点</a></li>
                    
                  
                    <li class=""><a href="#_2">客户自定义事件</a></li>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#_3">通过标签添提交自定义事件</a></li>
                      </ul>
                    
                      <ul class="nav nav-l2">
                        <li><a class="itm-l2" href="#meta">通过meta标签提交阅读标签</a></li>
                      </ul>
                    
                  
                    <li class=""><a href="#_4">来源跟踪</a></li>
                    
                  
                  </ul>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="../ioscollection/">通过IOS SDK进行事件采集</a>
                
              </li>

          

              <li class="">
                <a class="itm-l1" href="../androidcollection/">通过ANDROID SDK进行事件采集</a>
                
              </li>

          
        
      

    
    </ul>
</div></div>
        <div class="col-md-9 content-body" role="main">
             

<h1>通过JS SDK进行事件采集</h1>

<h2 id="_1">设置埋点</h2>
<p>登录DM Hub系统，点击菜单<strong>内容&gt;公司网站&gt;集成公司网站</strong>：
<img src="/resources/track1.png" width="600"/></p>
<p>按照页面的描述文字，将页面内的javascript代码放在官网主页的</html>之前。 如：
<img src="/resources/track2.png" width="600"/></p>
<p><strong>说明</strong></p>
<ol>
<li>
<p>this.push({})中的参数是一个JSON对象，该JSON对象便是整个页面追踪过程的上下文(context)信息，我们称之为<strong>页面参数</strong>(page parameters)。该JSON可以包含以下字段如下：</p>
<table>
<thead>
<tr>
<th align="left">字段名</th>
<th align="left">字段类型</th>
<th align="left">字段描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">channelType</td>
<td align="left">String</td>
<td align="left">表示集成的触点类型，需要小写英文字母，比如公司的英文名，或者网站的域名</td>
</tr>
<tr>
<td align="left">channelName</td>
<td align="left">String</td>
<td align="left">触点的名字，比如公司网站的名字</td>
</tr>
<tr>
<td align="left">userId</td>
<td align="left">String</td>
<td align="left">用户标识，如果公司网站有用户体系，可以是用户的id。</td>
</tr>
<tr>
<td align="left">source</td>
<td align="left">String</td>
<td align="left">访问来源</td>
</tr>
<tr>
<td align="left">tag</td>
<td align="left">String</td>
<td align="left">内容标签，多个标签可以用逗号分开</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>this.track()函数用户记录用户的访问行为，除了open_page行为，我们还可以通过自定义一些事件，来跟踪用户的页面点击行为。track()具有以下参数：
function track(event, targetName, targetId, properties, callback)</p>
<ul>
<li>event 自定义事件的id，后文会有描述</li>
<li>targetName 行为跟踪的目标名字，例如：收藏商品</li>
<li>targetId 行为跟踪的目标id</li>
<li>proprerties 可省略，如果提供，会覆盖push()所设置的页面参数</li>
<li>callback 可省略，如果提供，在完成track发送动作后，该callback会被调用</li>
</ul>
<p><strong>注</strong>：targetName和targetId必须同时出现或同时省略</p>
<p><strong>例子</strong>：this.track(‘c_1481629160265’, ‘收藏商品’, ‘p001’)</p>
</li>
</ol>
<h2 id="_2">客户自定义事件</h2>
<p>登录DM Hub系统，点击菜单中的<strong>客户&gt;客户设置&gt;客户关键事件</strong>中的<strong>新建客户事件</strong>。
<img src="../../resources/newcustomerevent1.png" width="600"/></p>
<p>点击<strong>确定</strong>，在事件列表中点击新建事件中的i图标，获取自定义事件ID：
<img src="../../resources/newcustomerevent2.png" width="600"/>
<img src="../../resources/newcustomerevent3.png" width="600"/></p>
<h3 id="_3">通过标签添提交自定义事件</h3>
<p>track()函数的参数event, targetName, targetId可以使用标签的形式向服务器提交。在按钮或链接上，分别添加如下属性：
- data-cl-event: 相当于track的event参数
- data-cl-name: 相当于track的targetName参数
- data-cl-id:  相当于track的targetId参数</p>
<pre><code>&lt;button data-cl-event=‘c_1483532925683’ data-cl-name=’收藏商品’ data-cl-id=’p001’&gt;收藏&lt;/button&gt;
</code></pre>

<hr />
<h3 id="meta">通过meta标签提交阅读标签</h3>
<p>除了在页面参数中指定内容标签外，还可以通过meta标签，给阅读过该页面的用户打上阅读标签，方法如下：</p>
<pre><code>&lt;meta name=”cl_content_tag” content=”咖啡,提神”&gt;
</code></pre>

<h2 id="_4">来源跟踪</h2>
<ol>
<li>进入<strong>客户&gt;来源管理</strong>，创建需要的来源</li>
<li>进入<strong>内容&gt;公司网站&gt;网页可追踪URL</strong>，创建可追踪URL，并选择需要的来源。</li>
<li>将可追踪URL传播出去，比如通过百度广告，邮件，微信等。</li>
<li>进入<strong>内容&gt;公司网站&gt;网站页面</strong>，可以看到网页的来源访问分析。</li>
</ol>
            <div class="ds-thread" data-thread-key="通过JS SDK进行事件采集" data-title="通过JS SDK进行事件采集" data-url=""></div>
        </div>
        
    </div>
    
    </script>
</body>

</html>